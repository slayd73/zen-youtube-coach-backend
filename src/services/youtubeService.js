// src/services/youtubeService.jsimport axios from "axios";const YT_API_KEY = process.env.YOUTUBE_API_KEY;/** * Ottiene gli ultimi video di un canale YouTube */export async function fetchChannelVideos(channelId, maxResults = 10) {  try {    const url = `https://www.googleapis.com/youtube/v3/search?key=${YT_API_KEY}&channelId=${channelId}&part=snippet,id&order=date&maxResults=${maxResults}`;    const response = await axios.get(url);    return response.data.items.map((item) => ({      videoId: item.id.videoId,      title: item.snippet.title,      description: item.snippet.description,      thumbnail: item.snippet.thumbnails?.high?.url,      publishedAt: item.snippet.publishedAt    }));  } catch (err) {    console.error("fetchChannelVideos ERROR:", err.message);    throw new Error("Failed to fetch channel videos.");  }}/** * Ottiene dettagli completi di un singolo video */export async function fetchVideoDetails(videoId) {  try {    const url = `https://www.googleapis.com/youtube/v3/videos?key=${YT_API_KEY}&id=${videoId}&part=snippet,statistics,contentDetails`;    const response = await axios.get(url);    const info = response.data.items[0];    return {      id: videoId,      title: info.snippet.title,      description: info.snippet.description,      thumbnail: info.snippet.thumbnails?.high?.url,      publishedAt: info.snippet.publishedAt,      duration: info.contentDetails.duration,      views: Number(info.statistics.viewCount || 0),      likes: Number(info.statistics.likeCount || 0),      comments: Number(info.statistics.commentCount || 0),      channelId: info.snippet.channelId    };  } catch (err) {    console.error("fetchVideoDetails ERROR:", err.message);    throw new Error("Failed to fetch video details.");  }}/** * Ottiene informazioni video + canale partendo da URL YouTube */export async function getVideoInfo(videoUrl) {  try {    // Estrai ID del video da URL    const match = videoUrl.match(/v=([a-zA-Z0-9_-]+)/);    const videoId = match ? match[1] : null;    if (!videoId) {      throw new Error("Invalid YouTube URL: unable to extract video ID");    }    // 1. Ottieni dettagli video    const video = await fetchVideoDetails(videoId);    // 2. Ottieni dettagli canale    let channel = null;    if (video.channelId) {      const url = `https://www.googleapis.com/youtube/v3/channels?key=${YT_API_KEY}&id=${video.channelId}&part=snippet,statistics`;      const response = await axios.get(url);      const info = response.data.items?.[0];      if (info) {        channel = {          id: video.channelId,          title: info.snippet.title,          description: info.snippet.description,          thumbnails: info.snippet.thumbnails,          subscribers: Number(info.statistics.subscriberCount || 0),          videos: Number(info.statistics.videoCount || 0),          views: Number(info.statistics.viewCount || 0)        };      }    }    return {      video,      channel    };  } catch (err) {    console.error("getVideoInfo ERROR:", err.message);    throw new Error("Failed to extract video info.");  }}