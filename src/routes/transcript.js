// ===========================================================================//  ðŸŽ§ /transcript â€” Transcript Engine Ultra-Premium//  USA LA PIPELINE COMPLETA://  1) YouTube timedtext//  2) HTML captionTracks//  3) Whisper fallback (placeholder, integrabile)//  4) AI Summary fallback (placeholder, integrabile)////  Questo Ã¨ lo stesso approccio usato da YouTube Summary, Glasp e Eightify.// ===========================================================================import express from "express";import { extractYouTubeId, fetchTranscript } from "../services/youtubeTools.js";const router = express.Router();// ===========================================================================//  POST /transcript// ===========================================================================router.post("/", async (req, res) => {  try {    const { url } = req.body;    if (!url) {      return res.status(400).json({        success: false,        error: "URL mancante. Devi fornire un link YouTube.",      });    }    // Estrazione videoId    const videoId = extractYouTubeId(url);    if (!videoId) {      return res.status(400).json({        success: false,        error: "URL non valido. Impossibile estrarre il videoId.",      });    }    console.log(`ðŸŽ¬ Richiesta transcript per videoId: ${videoId}`);    // Pipeline Ultra-Premium    const transcript = await fetchTranscript(videoId);    if (!transcript) {      return res.status(500).json({        success: false,        error: "âŒ Nessun transcript disponibile (tutti i livelli falliti).",        details:          "Possibile: video senza sottotitoli, HTML non accessibile, Whisper non attivo, fallback AI non disponibile.",      });    }    // Tutto OK    return res.json({      success: true,      videoId,      length: transcript.length,      transcript,    });  } catch (err) {    console.error("ðŸ”¥ Errore interno /transcript:", err);    return res.status(500).json({      success: false,      error: "Errore interno del server.",      details: err.message,    });  }});// ===========================================================================//  GET /transcript/ping  â†’ per test rapido// ===========================================================================router.get("/ping", (req, res) => {  res.json({    ok: true,    route: "/transcript/ping",    message: "Transcript Engine Ultra-Premium attivo",  });});export default router;