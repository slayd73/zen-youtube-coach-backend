// =========================================================// üß† pattern-for-me.js ‚Äî Personal Pattern Generator// Zen YouTube Coach Pro ‚Äî AI Engine 3.0// =========================================================import express from "express";import { callAI } from "../services/aiService.js";const router = express.Router();/** * POST /pattern-for-me * Genera una versione personalizzata dei pattern narrativi * per pubblico Over 50/60/70 + stile Zen Salute e Benessere. */router.post("/", async (req, res) => {  try {    const { basePattern, topic } = req.body || {};    if (!basePattern) {      return res.status(400).json({        error: true,        message: "Missing 'basePattern' field."      });    }    const prompt = `Sei "Zen Narrative Pattern Master", esperto in storytelling Over50/60/70.Genera SOLO JSON.OBIETTIVO:Adatta il seguente pattern narrativo per:- pubblico Over 50/60/70- canale "Zen Salute e Benessere"- tono umano, empatico, semplice- ritmo narrativo rapido ma dolcePATTERN ORIGINALE:${JSON.stringify(basePattern, null, 2)}TEMA (opzionale):${topic || "Nessun tema specifico"}FORMAT JSON:{  "adaptedPattern": {     "steps": [],     "notes": ""  }}`;    const aiRaw = await callAI(prompt, {      model: "gpt-4o-mini",      temperature: 0.65,      max_tokens: 2500    });    const aiResponse =      typeof aiRaw === "string" ? JSON.parse(aiRaw) : aiRaw;    return res.json({      success: true,      result: aiResponse    });  } catch (err) {    console.error("‚ùå /pattern-for-me ERROR:", err);    return res.status(500).json({      error: "Internal Server Error",      details: err.message    });  }});export default router;