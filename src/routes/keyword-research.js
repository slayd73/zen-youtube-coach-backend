// ======================================================// üîë /keyword-research ‚Äî Ricerca keyword strategica// ======================================================import express from "express";import { callAIModel } from "../services/aiEngine.js";const router = express.Router();/** * Body: * { *   "topic": "argomento principale", *   "audience": "over60", *   "forceProvider": "auto" * } */router.post("/", async (req, res) => {  try {    const {      topic,      audience = "over60",      forceProvider = "auto"    } = req.body || {};    if (!topic) {      return res.status(400).json({        ok: false,        error: "Missing 'topic'"      });    }    const prompt = `Sei un tool tipo VidIQ/Tubebuddy ma pi√π intelligente.Tema: "${topic}"Target: ${audience}Genera SOLO JSON:{  "keywordPrincipale": "keyword",  "keywordSecondarie": ["..."],  "longTail": ["..."],  "ideeTagYouTube": ["tag1", "tag2", "tag3"],  "angoliRicerca": [    {      "nome": "dolore|desiderio|segreto",      "esempi": ["...","..."]    }  ]}`.trim();    const aiResp = await callAIModel(prompt, "json", {      task: "keyword-research",      temperature: 0.3,      maxTokens: 4000,      forceProvider    });    if (aiResp?.error) {      return res.status(502).json({        ok: false,        error: "AI keyword research failed",        details: aiResp      });    }    return res.json({      ok: true,      providerUsed: forceProvider,      data: aiResp    });  } catch (err) {    console.error("‚ùå /keyword-research ERROR:", err);    res.status(500).json({      ok: false,      error: "keyword-research route crashed",      details: err.message    });  }});export default router;