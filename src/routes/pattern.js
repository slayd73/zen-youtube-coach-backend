// ==========================================================// üß† pattern.js ‚Äî Video Pattern Analyzer (AI Engine 3.0)// ==========================================================import express from "express";import { callAIModel } from "../services/aiEngine.js";const router = express.Router();/** * POST /pattern * Analizza una trascrizione e restituisce: * - struttura narrativa * - punti di forza * - punti deboli * - pattern narrativo ricorrente * Versione compatibile con AI Engine 3.0 */router.post("/", async (req, res) => {  try {    const { transcript } = req.body;    if (!transcript) {      return res.status(400).json({        error: "Missing 'transcript' field."      });    }    const prompt = `Sei "Zen Pattern Master AI".Analizza il seguente transcript e restituisci SOLO JSON valido.TRANSCRIPT:${transcript.slice(0, 8000)}FORMAT JSON:{  "structure": [],  "strengths": [],  "weaknesses": [],  "recurringPattern": "",  "insights": []}`;    const ai = await callAIModel(prompt, "json", {      task: "pattern-analysis",      temperature: 0.5,      maxTokens: 2500,    });    return res.json({      success: true,      result: ai    });  } catch (err) {    console.error("‚ùå /pattern ERROR:", err);    return res.status(500).json({      error: "Internal Server Error",      details: err.message    });  }});export default router;