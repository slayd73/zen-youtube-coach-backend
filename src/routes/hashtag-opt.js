// ======================================================// #️⃣ /hashtag-opt — Generatore hashtag ottimizzati// ======================================================import express from "express";import { callAIModel } from "../services/aiEngine.js";const router = express.Router();/** * Body: * { *   "topic": "tema o titolo video", *   "audience": "over60", *   "forceProvider": "auto" * } */router.post("/", async (req, res) => {  try {    const {      topic,      audience = "over60",      forceProvider = "auto"    } = req.body || {};    if (!topic) {      return res.status(400).json({        ok: false,        error: "Missing 'topic'"      });    }    const prompt = `Genera hashtag per un video YouTube (e Shorts) sul tema:"${topic}"Target: ${audience}Rispondi SOLO JSON:{  "hashtagYouTube": ["#...","#..."],  "hashtagShorts": ["#shorts","#..."],  "mixConsigliato": ["#...","#..."]}`.trim();    const aiResp = await callAIModel(prompt, "json", {      task: "hashtag-opt",      temperature: 0.3,      maxTokens: 2500,      forceProvider    });    if (aiResp?.error) {      return res.status(502).json({        ok: false,        error: "AI hashtag optimization failed",        details: aiResp      });    }    return res.json({      ok: true,      providerUsed: forceProvider,      data: aiResp    });  } catch (err) {    console.error("❌ /hashtag-opt ERROR:", err);    res.status(500).json({      ok: false,      error: "hashtag-opt route crashed",      details: err.message    });  }});export default router;