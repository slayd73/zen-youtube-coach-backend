// ======================================================// ðŸŽ¬ /script-from-video â€” Generate Script from Video Info// ======================================================import express from "express";import { callAIModel } from "../services/aiEngine.js";import { getTranscript } from "../services/transcriptService.js";import { getVideoInfo } from "../services/videoInfoService.js";const router = express.Router();router.post("/", async (req, res) => {  try {    const { videoUrl, audience = "over60", forceProvider = "auto" } = req.body;    if (!videoUrl) return res.status(400).json({ ok: false, error: "Missing videoUrl" });    const videoId = extractId(videoUrl);    const transcript = await getTranscript(videoId);    const info = await getVideoInfo(videoId);    const prompt = `Genera script completo stile Zen Salute e Benessere.Pubblico: ${audience}Titolo originale: ${info.data.title}Transcript base:${transcript.continuousText}Rispondi JSON:{  "script": "...",  "hook": "...",  "sezioni": ["..."],  "cta": "..."}`;    const aiResp = await callAIModel(prompt, "json", {      task: "script-drafting",      temperature: 0.35,      maxTokens: 6500,      forceProvider    });    res.json({ ok: true, data: aiResp });  } catch (err) {    res.status(500).json({ ok: false, error: err.message });  }});function extractId(u) {  let m = u.match(/v=([\w-]{11})/); if (m) return m[1];  m = u.match(/youtu\.be\/([\w-]{11})/); if (m) return m[1];  return null;}export default router;