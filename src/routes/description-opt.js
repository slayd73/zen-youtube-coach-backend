// ======================================================// üìù /description-opt ‚Äî Ottimizzatore descrizione video// ======================================================import express from "express";import { callAIModel } from "../services/aiEngine.js";const router = express.Router();/** * Body: * { *   "title": "titolo video", *   "currentDescription": "descrizione attuale (opzionale)", *   "audience": "over60", *   "forceProvider": "auto" * } */router.post("/", async (req, res) => {  try {    const {      title,      currentDescription = "",      audience = "over60",      forceProvider = "auto"    } = req.body || {};    if (!title) {      return res.status(400).json({        ok: false,        error: "Missing 'title'"      });    }    const prompt = `Ottimizza la descrizione di un video YouTube.Titolo: "${title}"Descrizione attuale (se presente):${currentDescription}Target: ${audience}Rispondi SOLO JSON:{  "descrizioneOttimizzata": "testo completo con paragrafi e spaziature",  "primaRigaPotente": "prima riga che aggancia",  "bulletPuntiChiave": ["..."],  "callToAction": "..."}`.trim();    const aiResp = await callAIModel(prompt, "json", {      task: "description-opt",      temperature: 0.3,      maxTokens: 4000,      forceProvider    });    if (aiResp?.error) {      return res.status(502).json({        ok: false,        error: "AI description optimization failed",        details: aiResp      });    }    return res.json({      ok: true,      providerUsed: forceProvider,      data: aiResp    });  } catch (err) {    console.error("‚ùå /description-opt ERROR:", err);    res.status(500).json({      ok: false,      error: "description-opt route crashed",      details: err.message    });  }});export default router;