// ======================================================================// ğŸ“¥ import-transcript.js  â€” Zen YouTube Coach Pro// Endpoint UNIFICATO per importare transcript in un solo passaggio.// ======================================================================import express from "express";import { getTranscript } from "../services/transcriptService.js";const router = express.Router();/** * POST /transcript/import * * Body: * { *   "videoUrl": "https://www.youtube.com/watch?v=...", *   "manualTranscript": "...", *   "manualSummary": "...", *   "debug": false * } */router.post("/", async (req, res) => {  try {    const {      videoUrl,      manualTranscript,      manualSummary,      debug = false,    } = req.body || {};    if (!videoUrl) {      return res.status(400).json({        success: false,        error: true,        message: "videoUrl mancante. Devi fornire almeno l'URL del video YouTube.",      });    }    // ğŸŸ¢ Step 1 â€” Estrarre Transcript con prioritÃ  assoluta a manualTranscript    const transcriptResult = await getTranscript(videoUrl, {      manualTranscript,      manualSummary,      forceRefresh: true,      debug,    });    if (!transcriptResult.success) {      return res.status(500).json({        success: false,        error: true,        message: "Errore nell'import del transcript.",        details: transcriptResult.message || "Unknown error.",      });    }    // ğŸŸ¢ Step 2 â€” Preparare output â€œUI Friendlyâ€    const response = {      success: true,      imported: true,      provider: transcriptResult.provider,      videoId: transcriptResult.videoId,      transcriptLength: transcriptResult.continuousText.length,      preview: transcriptResult.continuousText.slice(0, 500) + "â€¦",      fullTranscript: transcriptResult.continuousText,      timestamp: new Date().toISOString(),      // ğŸ”¥ Step successivi disponibili      nextActions: {        analyze: "/analyze-transcript",        compare: "/compare-transcript",        compareVideos: "/compare-videos",        retention: "/retention-analyze",        titles: "/generateTitle",        script: "/generateScriptPro",        thumbnails: "/generateThumbnailIdeas",      },    };    return res.json(response);  } catch (error) {    console.error("âŒ Errore in /transcript/import:", error);    return res.status(500).json({      success: false,      error: true,      message: "Errore interno durante l'import transcript.",      details: error.message,    });  }});export default router;